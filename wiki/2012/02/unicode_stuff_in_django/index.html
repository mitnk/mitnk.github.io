<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <link rel="shortcut icon" href="/media/favicon.ico" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" href="/media/css/main.css" />
  <link type="text/css" rel="stylesheet" href="/media/css/paginator.css" />

  <link type="text/css" rel="stylesheet" href="/media/css/pygments.css" />


  <title>Mitnk's Blog</title>
</head>

<body>
<div id="header">
    <div class="wrapper">
        <p class="title">Mitnk's Blog</p>
        <p>Welcome here.</p>
    </div>
</div>

<div id="wrapper">
    <div id="menu">
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/about/">About</a></li>
            <!--
            <li><a href="/category/">Archives</a></li>
            -->
            <li> <div id="header-search">
<form id="cse-form" action="http://www.google.com/cse">
  <input type="hidden" name="siteurl" value="mitnk.com" />
  <input type="hidden" value="001178881884595255196:zxbbdpwksnw" name="cx" />
  <input type="text" id="cse-input" value="Search" name='q' onFocus="enter_search_box()" onBlur="leave_search_box()" />
</form>
</div>
 </li>
        </ul>
    </div>

    <div id="content">
        
<div class="entry">
    <article itemtype="http://schema.org/Blog">
        <h1 class="entry-title">Unicode Stuff In Django</h1>
        <div class="entry-content">
            <ol>
<li>
<p>Creating the database with encoding of utf-8</p>
</li>
<li>
<p><code>django.utils.encoding</code> functions:</p>
<ul>
<li>smart_unicode</li>
<li>force_unicode</li>
<li>smart_str</li>
</ul>
<p>Normally, you'll only need to use <code>smart_unicode()</code>. Call it as early as possible on any input data that might be either Unicode or a <code>bytestring</code>, and from then on, you can treat the result as always being Unicode.</p>
</li>
<li>
<p>The functions <code>django.utils.http.urlquote()</code> and <code>django.utils.http.urlquote_plus()</code> are versions of Python’s standard <code>urllib.quote()</code> and <code>urllib.quote_plus()</code> that work with non-ASCII characters. (The data is converted to UTF-8 prior to encoding.)</p>
<p>The <code>iri_to_uri()</code> function will not change ASCII characters that are otherwise permitted in a URL. So, for example, the character ‘%’ is not further encoded when passed to <code>iri_to_uri()</code>. This means you can pass a full URL to this function and it will not mess up the query string or anything like that.</p>
<p>An example might clarify things here:</p>
<p><code class="python"></code></p>
<blockquote>
<blockquote>
<blockquote>
<p>urlquote(u'Paris &amp; Orléans')
u'Paris%20%26%20Orl%C3%A9ans'
iri_to_uri(u'/favorites/François/%s' % urlquote(u'Paris &amp; Orléans'))
'/favorites/Fran%C3%A7ois/Paris%20%26%20Orl%C3%A9ans'
</p></blockquote></blockquote></blockquote></li></ol>



<p>If you look carefully, you can see that the portion that was generated by <code>urlquote()</code> in the second example was not double-quoted when passed to <code>iri_to_uri()</code>. This is a very important and useful feature.</p>

<li>
<p>All strings are returned from the database as Unicode strings.</p>
<p>In particular, rather than giving your model a <code>__str__()</code> method, we recommended you implement a <code>__unicode__()</code> method.</p>
</li>
<li>
<p>Taking care in <code>get_absolute_url()</code></p>
<p><code class="python">
def get_absolute_url(self):
    url = u'/person/%s/?x=0&amp;y=0' % urlquote(self.location)
    return iri_to_uri(url)
</code></p>
</li>
<li>
<p>Always return Unicode strings from a template tag's render() method and from template filters. Use <code>force_unicode()</code> in preference to <code>smart_unicode()</code> in these places.</p>
</li>

<p>From: <a href="http://docs.djangoproject.com/en/dev/ref/unicode/#ref-unicode">Django Docs</a></p>
        </div>
    </article>

    <div class="entry-meta">
        Posted at June 15, 2014
    </div>

</div>

    </div>

    <div id="footer">
      Power by <a href="http://twitter.com/mitnk">@mitnk</a> 2012
    </div>
</div>

<script type="text/javascript" src="/media/js/main.js"> </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18137446-1']);
  _gaq.push(['_setDomainName', '.mitnk.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</body>
</html>
